<app-search-nav></app-search-nav>
<div class="container-fluid mt-5">
  <div class="row">
    <div class="col-sm-12">
      <div class="mb-3" style="max-width: 100%;">
        <h3 class="card-heading text-center pt-3">
          <i class="fas fa-cog"></i>
          <span class="glyphicon glyphicon-cog blueIcon" aria-hidden="true"></span> 
          Admin Dashboard
        </h3>
        <div class="card-body">
          <div class="row">
            <div class="col-sm-6">
              <div class="well">
                <h3>Stores:
                  <span class="badge badge-info">{{stores.length}}</span>
                </h3>
                <input type="text" class="form-control" [(ngModel)]="filter" (ngModelChange)="filterStores()" placeholder="Filter" value="{{filter}}">
                <div class="list-group-item" *ngFor="let store of stores; let i = index">
                  <span>
                    <button (click)="deleteStore(store.id, i)" class="btn btn-danger">X</button>
                  </span>
                  <button class="storeButton btn btn-link" data-toggle="collapse" [attr.data-target]="'#storeInfo'+i">{{store.name}}</button>
                  <div [attr.id]="'storeInfo'+i" class="panel-collapse collapse">
                    <div id="products" class="panel-body mt-3">
                      <span>Zero waste Products:</span>
                      <input type="text" [attr.id]="'products'+i" name="products" value="{{store.products}}" class="form-control" required>
                      <div class="row">
                        <div class="ml-auto col-5 text-right">
                          <button class="btn btn-success mt-2" (click)="updateStore(store, i)" href="#">Update Store</button>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div class="col-sm-6">
              <div class="well">
                <h3>Messages:
                  <span class="badge badge-info">{{messages.length}}</span>
                </h3>
                <div *ngFor="let message of messages; let i = index" class="list-group-item">
                  <div class="row">
                    <div class="col-md-2">
                      <span>
                        <button (click)="deleteMessage(message._id, i)" class="btn btn-danger">X</button>
                      </span>
                    </div>
                    <div class="col-md-6">
                      <button class="storeButton btn btn-link" data-toggle="collapse" [attr.data-target]="'#messageInfo'+i">{{message.subject}}</button>
                    </div>
                    <div class="col-md-4">
                      <span class="badge">{{message.Created_at | slice:0:10}}</span>
                    </div>
                  </div>
                  <div [attr.id]="'messageInfo'+i" class="panel-collapse collapse">
                    <div id="products" class="panel-body mt-3">
                      <span>Name: {{message.name}}</span>
                      <p>Email:
                        <a href="mailto:{{message.email}}">{{message.email}}</a>
                      </p>
                      <p>Message: {{message.message}}</p>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
